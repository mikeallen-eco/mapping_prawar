# The 'Mapping Warbler Song' Project
In this project, we'll build on the work of a previous project: 'Mapping Birdsong' (https://github.com/mikeallen-eco/mapping_birdsong). In that project, students picked a species, measured aspects of its song, and mapped them to reveal vocal dialects. It produced some interesting results, but our sample sizes were low. So, in this project, we'll double down on this approach and band together to increase our sample size. As a class, we'll measure sonogram properties to map the vocal dialects of a single species, the Prairie Warbler, across the eastern US. To do this, we'll use the > 500 high-quality songs for the species available via the Cornell Laboratory of Ornithology Macaulay Library's extensive collections. Most of those recorded songs were recorded by citizen scientists as part of their eBird checklists. We'll use low-tech tools (rulers! our eyes!) to collect 3 different measurements and then map them to see what the data tell us. While this analysis won't reveal WHY these patterns occur (e.g., learned dialects, local evolution), it may reveal some new questions that are worth exploring!

## Overview
Each group will be assigned 50 song recordings from the Prairie Warbler song database downloaded from the Macaulay Library. As a group, you will view the sonogram for each song and make 3 measurements, and record your data. Then we'll combine all the class data into one database and map the results.

## Phase 1: get and format your data files
0. If you don't have (or want) RStudio on your computer log into the virtual computer lab (https://it.rutgers.edu/virtual-computer-labs/). In the virtual lab, RStudio is located in the "Programs" folder in the "Class Software" subfolder.
1. Open a web browser and go to: https://github.com/mikeallen-eco/mapping_birdsong.
Download the code repository by clicking the green "Code" button. Unzip the folder it somewhere you can find it. (Don't change any folder or file names or locations yet.)
2. Now, look through your field guide paying special attention to species range maps and comments about their vocalizations. Select a species that interests you and that you think might have an interesting evolutionary story to tell.
3. Back in the web browser, go to https://www.macaulaylibrary.org/ and enter a species name in the search box to start viewing sonograms for your species. View many examples of the species' sonograms. Think of an interesting property of the song that you can measure either visually (e.g., syllable counts, max frequency) or with a ruler (e.g., syllables per second, total trill duration, duration of some other part of the song, etc.). 
4. Use the 'filters' in the Macaulay website to limit your selection to 1) audio by clicking the speaker button in the header, and 2) song (unless you want to analyze call notes) by clicking "More filters" and checking the "song" box.
5. Download the spreadsheet (csv file) for the resulting data.
6. Move the csv file you downloaded into the "my_raw_data" folder of the code repository you downloaded. DELETE THE EXAMPLE FILE THAT IS CURRENTLY IN THERE FIRST. THERE SHOULD ONLY BE ONE FILE IN THE my_raw_data FOLDER.
7. Now it's time to process your song data file. Open the R project by double clicking the "mapping_birdsong.Rproj" file. This will only work if you 1) are in a virtual lab workstation with RStudio installed, or 2) you have it installed on your own computer. (They are free programs.)
8. Within RStudio, open the file called "mapping_birdsong.Rmd". This file contains code to process your raw data file (which should now be the only file in your "my_raw_data" folder) along with directions on how to run it. Follow the directions in that file. If you do it correctly, it should result in two new files called "my_blank_data_file_latitude.csv" and "my_blank_data_file_longitude.csv" being created in the "my_output" folder. This file contains a subset of songs from the original raw data file that were chosen to be a random sample of about 25-50 songs, spread out over space (latitude or longitude, respectively), and including only those with a "quality" rating of 4 or higher.

Once you are done running the code for Step 8, come back here...

## Phase 2: make your measurements
9. Open the "my_output" folder.
10. Rename the newly-created files "my_blank_data_file_latitude.csv" and "my_blank_data_file_longitude.csv" to "my_complete_data_file_latitude.csv" and "my_complete_data_file_longitude.csv", respectively. This will prevent you from accidentally overwriting the file with a blank one if you happen to run the code again.
11. Time to find a sonogram and make your first measurement. Pick  whether you want to look at latitude or longitude first. Using your favorite spreadsheet software, open the appropriate file: "my_complete_data_file_latitude.csv" or "my_complete_data_file_longitude.csv". Make the columns wider if needed. Paste the first URL in the "link" column into a web browser. It will look something like this: https://macaulaylibrary.org/asset/110249
12. Now use a ruler (or your eyes) to make your first measurement on the sonogram associated with that link. Remember, it can be anything you think might vary: trill rate (syllables/s)? minimum, maximum, or range of frequencies (kilohertz)? a ratio of some sort? the duration of a certain part of the song (seconds)? Just be sure to keep your method of measurement consistent throughout all samples. To standardize things, measure the first example of whatever you are measuring that appears in the sonogram (e.g., if you are interested in trills, measure the first trill that appears in each sonogram). Put the measured value (number) in the "measurement" column. Put the units (seconds, syllables/second, kHz, etc.) in the "measurement_units" column. Hint: if you use a ruler to measure height or width on the sonogram in mm, be sure to convert to time or frequency when inputting data. Do this by also measuring the height of 1 kHz or 1 second.
13. Repeat this process for each link in the data file. Be sure to save your "my_complete_data_file_latitude.csv" or  "my_complete_data_file_longitude.csv" file. You can stop partway and finish later. If you are on a virtual lab machine, be sure to email yourself the data or otherwise save it safely. You can take the whole code repository with you by "zipping" the whole "mapping_birdsong" folder you are working in and emailing it to yourself. 
14. At some point while you are measuring, take a screenshot of a representative sonogram and annotate it with text and markings showing what you measured. Save it as a file called "methods_screenshot.png" (or .jpg) to the "my_output" folder. You will refer to this in your Methods text below.

## Phase 3: plot your results
15. Once you are done collecting all your measurements, go back to the "mapping_birdsong.Rmd" file in RStudio to plot your results. DO NOT RE-RUN ALL THE CODE. At this point, you just want to run the part that says "Graph the results" near the bottom. This will produce a plot of your measurement (on the y-axis) versus latitude and longitude (on the x-axis). BE SURE TO CHANGE THE SPECIES NAME AND MEASUREMENT UNITS BEFORE YOU MAKE THE PLOTS. The section after that will also produce a map of the measurements. These two chunks of code will also save all plots as png files to your "my_output" folder.
16. Depending on which R version you are using, you may encounter an error installing the required package "rnaturalearthhires". If so, try first installing the package "devtools" and then the "rnaturalearthhires" package using this command: 
```
install.packages("devtools")
devtools::install_github("ropensci/rnaturalearthhires")
```
17. Describe your Methods by editing and running the relevant chunk of code in "mapping_birdsong.Rmd" that follows the one where you made your plot. Be sure to reference the screenshot figure you made.
18. Describe your Results by editing and running the relevant chunk of code in "mapping_birdsong.Rmd" that follows the one where you wrote your Methods. Be sure to reference the figure you made that plotted your measurements vs. latitude or longitude. Did you find a clear pattern, no pattern, or something in between? Do you recommend future birdsong mappers to collect more data on this hypothesis?
